function checkFixedColumns(){return $(".tb_display thead th").length>10?{rightColumns:1,leftColumns:0}:$(".tb_display thead th").length>15?{rightColumns:1,leftColumns:3}:void 0}function checkScrollX(){return $(".tb_display thead th").length>7}function checkScrollY(){return $(".tb_display thead th").length>10?"400px":""}function reloadTable(){_table.ajax.reload(null,!1)}function Destroy(e){let t=SITE_URL+DELETE+e,a="delete",n=isAccess(a,LAST_URL);n[0].success&&"Y"==n[0].message?Swal.fire({title:"Delete?",text:"Are you sure you wish to delete the selected data ? ",type:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Okay",cancelButtonText:"Close",reverseButtons:!0}).then(e=>{e.value&&$.getJSON(t,function(e){e[0].success?(Swal.fire({title:"Deleted!",text:"Your data has been deleted.",type:"success",showConfirmButton:!1,timer:1e3}),reloadTable()):e[0].error?console.info(e):(Swal.fire({title:"Error!",text:e[0].message,type:"error",showConfirmButton:!0}),reloadTable())}).fail(function(e,t,a){console.info(a),reloadTable()})}):n[0].success&&"N"==n[0].message?Toast.fire({type:"error",title:"You are role don't have permission, please reload !!"}):Toast.fire({type:"error",title:n[0].message})}function docProcess(e,t){let a="update",n=isAccess(a,LAST_URL),i='<div class="d-flex justify-content-center"><select id="docaction">';i+="DR"===t?'<option value=""></option><option value="CO">Complete</option><option value="VO">Void</option>':'<option value=""></option><option value="VO">Void</option>',i+="</select></div>",n[0].success&&"Y"==n[0].message?Swal.fire({title:"Document Action",html:i,showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonText:"Ok",cancelButtonText:"Close",showLoaderOnConfirm:!0,reverseButtons:!0,onOpen:()=>{$("#docaction").select2({placeholder:"Select an option",width:"40%",theme:"bootstrap"})},preConfirm:t=>new Promise(function(t){let a=$("#docaction option:selected").val(),n=SITE_URL+"/processIt?id="+e+"&docaction="+a;$.getJSON(n,function(e){e[0].success&&(1==e[0].message?Swal.fire({title:"Success !!",text:"Your data has been process",type:"success",showConfirmButton:!1,timer:1e3}):Swal.fire({title:"Error!",text:e[0].message,type:"error",showConfirmButton:!1,timer:1e3}),reloadTable()),(void 0!==e[0].error&&e[0].error||void 0!==e[0].error&&!e[0].error)&&(Swal.showValidationMessage(e[0].message),t(!1))}).fail(function(e,a,n){Swal.showValidationMessage(n),t(!1),reloadTable()})}),allowOutsideClick:()=>!Swal.isLoading()}):n[0].success&&"N"==n[0].message?Toast.fire({type:"error",title:"You are role don't have permission, please reload !!"}):Toast.fire({type:"error",title:n[0].message})}function arrContains(e,t){var a=null;for(let i=0;i<t.length;i++){var n=t[i];if(n.toString().toLowerCase()===e.toString().toLowerCase()){a=n;break}}return a}function errorForm(e,t){const a=e.find("input, select, textarea"),n=e.find("small");let i=[],o=[];for(let e=0;e<n.length;e++)""!==n[e].id&&o.push(n[e].id);for(let e=0;e<a.length;e++)i.push(a[e].name);for(let a=0;a<t.length;a++){let n=t[a].error,s=t[a].field,r=t[a].label,l=arrContains(n,o),d=arrContains(s,i);if(""!==r&&a>0){if(e.find("small[id="+l+"]:not(.line)").html(r),e.find("input:text[name="+d+"]:not(.line), select[name="+d+"]:not(.line), textarea[name="+d+"]:not(.line), input:password[name="+d+"]:not(.line)").closest(".form-group").addClass("has-error"),e.find("table.tb_displayline").length>0){"line"===s&&Toast.fire({type:"error",title:r});const e=_tableLine.rows().nodes().to$().find("input, select");let t=[];$.each(e,function(e){let a=this.value,i=$(this).attr("name"),o=$(this)[0].className.split(/\s+/),l=$(this).closest("tr")[0]._DT_RowIndex;if($(this).attr("required")){let e=Number(l+1);if(void 0!==n&&"error_table"===n&&""!==r)if(i!==s||""!==a&&0!=a)if(i===s&&""!==a){t.push(a);let e=findArrDuplicate(t),n=r.split("|")[0].trim();e.length>0&&e.includes(a)&&o.includes("unique")?($(this).closest(".form-group").addClass("has-error"),Toast.fire({type:"error",title:r})):n===a?(r=r.split("|")[1].trim(),$(this).closest(".form-group").addClass("has-error"),Toast.fire({type:"error",title:r})):$(this).closest(".form-group").removeClass("has-error")}else o.includes("unique")||""===a||$(this).closest(".form-group").removeClass("has-error");else $(this).closest(".form-group").addClass("has-error"),Toast.fire({type:"error",title:r+" : "+e});else void 0!==n&&"error_table"!==n&&$(this).closest(".form-group").removeClass("has-error")}})}}else e.find("small[id="+l+"]:not(.line)").html(""),e.find("input:text[name="+d+"]:not(.line), select[name="+d+"]:not(.line), textarea[name="+d+"]:not(.line), input:password[name="+d+"]:not(.line)").closest(".form-group").removeClass("has-error")}}function findArrDuplicate(e){return e.filter(function(e,t,a){return a.indexOf(e)!=t})}function clearForm(e){$(e.target).closest(".container");let t=$(e.target).closest(".row").length>0?$(e.target).closest(".row"):$(e.target).closest(".modal");const a=t.find("form"),n=a.find("input, textarea, select"),i=a.find("small");a[0].reset();let o="/quotation/defaultLogic",s=getLogic(o);for(let e=0;e<n.length;e++)if(""!==n[e].name){$("select[name="+n[e].name+"]").attr("default-id");if(0==fieldReadOnly.length?a.find("input[name="+n[e].name+"], textarea[name="+n[e].name+"]").removeAttr("readonly").closest(".form-group").removeClass("has-error"):fieldReadOnly.length>0&&(fieldReadOnly.includes(n[e].name)?a.find("input[name="+n[e].name+"], textarea[name="+n[e].name+"]").closest(".form-group").removeClass("has-error"):a.find("input[name="+n[e].name+"], textarea[name="+n[e].name+"]").removeAttr("readonly").closest(".form-group").removeClass("has-error")),a.find("input:checkbox[name="+n[e].name+"]").removeAttr("disabled"),s.length>0&&n[e].name===s[0].field&&s[0].condition?0==fieldReadOnly.length?a.find("select[name="+n[e].name+"]").val(s[0].id).change().removeAttr("disabled").closest(".form-group").removeClass("has-error"):fieldReadOnly.length>0&&(fieldReadOnly.includes(n[e].name)?a.find("select[name="+n[e].name+"]").val(s[0].id).change().closest(".form-group").removeClass("has-error"):a.find("select[name="+n[e].name+"]").val(s[0].id).change().removeAttr("disabled").closest(".form-group").removeClass("has-error")):0==fieldReadOnly.length?a.find("select[name="+n[e].name+"]").val(null).change().removeAttr("disabled").closest(".form-group").removeClass("has-error"):fieldReadOnly.length>0&&(fieldReadOnly.includes(n[e].name)?a.find("select[name="+n[e].name+"]").val(null).change().closest(".form-group").removeClass("has-error"):a.find("select[name="+n[e].name+"]").val(null).change().removeAttr("disabled").closest(".form-group").removeClass("has-error")),"file"==n[e].type&&$(".close-img").click(),(a.find("textarea.summernote[name="+n[e].name+"]").length>0||a.find("textarea.summernote-product[name="+n[e].name+"]").length>0)&&($("[name ="+n[e].name+"]").summernote("reset"),$("[name ="+n[e].name+"]").summernote("enable")),a.find("table.tb_displayline").length>0){_tableLine.clear().draw();const e=_tableLine.rows().to$().find("button");$(".add_row").css("display","block"),e.css("display","block")}$(n[e]).attr("edit-disabled")&&a.find("input:checkbox[name="+n[e].name+"], select[name="+n[e].name+"], input:radio[name="+n[e].name+"]").removeAttr("disabled")}for(let e=0;e<i.length;e++)""!==i[e].id&&a.find("small[id="+i[e].id+"]").html("");option=[]}function readonly(e,t){const a=e.find("input, textarea, select");for(let n=0;n<a.length;n++)if(""!==a[n].name){let i=a[n].className.split(/\s+/);(a[n].readOnly||a[n].disabled)&&fieldReadOnly.push(a[n].name),fieldReadOnly.includes(a[n].name)||e.find("input:text[name="+a[n].name+"], textarea[name="+a[n].name+"], input:password[name="+a[n].name+"]").prop("readonly",t),"text"===a[n].type||i.includes("active")||fieldReadOnly.includes(a[n].name)||e.find("input:checkbox[name="+a[n].name+"], select[name="+a[n].name+"], input:radio[name="+a[n].name+"]").prop("disabled",t),"file"===a[n].type&&e.find("input[name="+a[n].name+"]").prop("disabled",t),(e.find("textarea.summernote[name="+a[n].name+"]").length>0||e.find("textarea.summernote-product[name="+a[n].name+"]").length>0)&&(t?$("[name ="+a[n].name+"]").summernote("disable"):$("[name ="+a[n].name+"]").summernote("enable"))}e.find("button.close-img").length>0&&(e.find("button.close-img").prop("disabled",t),t?e.find("button.close-img").css("display","none"):e.find("button.close-img").css("display","block"))}function previewImage(e,t,a){let n=e.closest("label");if(t=t||".img-result",a=null==a?"":a,e.files&&e.files[0]){let a=new FileReader;a.onload=function(e){loadingForm(n.id,"pulse"),$(".save_form").attr("disabled",!0),$(".x_form").attr("disabled",!0),$(".close_form").attr("disabled",!0),setTimeout(function(){$(t).attr("src",e.target.result).width("auto").height(150),$(".form-upload-foto").css("display","none"),$(".form-result").css("display","block"),hideLoadingForm(n.id),$(".save_form").removeAttr("disabled"),$(".x_form").removeAttr("disabled"),$(".close_form").removeAttr("disabled")},2500)},a.readAsDataURL(e.files[0])}else""!==a?(a=ORI_URL+"/"+a,$.ajax({url:a,type:"HEAD",error:function(){$(t).attr("src","").width("auto").height(150),$(".form-upload-foto").css("display","block"),$(".form-result").css("display","none")},success:function(){loadingForm(n.id,"pulse"),$(".save_form").attr("disabled",!0),$(".x_form").attr("disabled",!0),$(".close_form").attr("disabled",!0),setTimeout(function(){$(t).attr("src",a).width("auto").height(150),$(".form-upload-foto").css("display","none"),$(".form-result").css("display","block"),hideLoadingForm(n.id),$(".save_form").removeAttr("disabled"),$(".x_form").removeAttr("disabled"),$(".close_form").removeAttr("disabled")},500)}})):($(t).attr("src","").width("auto").height(150),$(".form-upload-foto").css("display","block"),$(".form-result").css("display","none"))}function isAccess(e,t){let a,n=ADMIN_URL+"accessmenu/getAccess";return $.ajax({url:n,type:"POST",data:{last_url:t,action:e},async:!1,dataType:"JSON",success:function(e){a=e},error:function(e,t){showError(e,t)}}),a}function setSeqCode(e){let t=SITE_URL+"/getSeqCode";$.getJSON(t,function(t){e.find("input.code").val(t[0].message)}).fail(function(e,t){showError(e,t)})}function showError(e,t){let a="";a=0===e.status?"Not connect.\n Verify Network.":404==e.status?"Requested page not found. [404]":500==e.status?"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error.\n"+e.responseText,Toast.fire({type:"error",title:a})}function loadingForm(e,t){$("#"+e).waitMe({effect:t,text:"Please wait...",bg:"rgba(255,255,255,0.7)",color:"#000",maxSize:"",waitTime:-1,textPos:"vertical",fontSize:"100%",source:"",onClose:function(){}})}function hideLoadingForm(e){$("#"+e).waitMe("hide")}function openModalForm(){return $(".modal_form").modal({backdrop:"static",keyboard:!1})}function Scrollmodal(){return modalDialog.addClass("modal-dialog-scrollable")}function formatRupiah(e){let t=e.toString(),a=t.split(","),n=a[0].length%3,i=a[0].substr(0,n),o=a[0].substr(n).match(/\d{3}/gi);return o&&(separator=n?".":"",i+=separator+o.join(".")),i||""}function replaceRupiah(e){return e.replace(/\./g,"")}function initSelectData(e){$.each(e,function(e,t){let a=$(t).attr("data-url"),n=$(t).attr("default-id"),i=$(t).attr("default-text");if(void 0!==a&&""!==a&&($(this).select2({placeholder:"Select an option",width:"100%",theme:"bootstrap",allowClear:!0,ajax:{dataType:"JSON",url:function(){return ADMIN_URL+a},delay:250,data:function(e){return{search:e.term}},processResults:function(e,t){return{results:e}},cache:!0}}),void 0!==n&&""!==n&&void 0!==i&&""!==i)){let e=$("<option selected='selected'></option>").val(n).text(i);$(this).append(e).change()}})}function getList(e,t,a){let n;return $.ajax({url:ADMIN_URL+e,type:"POST",data:{field:t,reference:a},async:!1,dataType:"JSON",success:function(e){n=e}}),n}function removeItems(e,t){const a=e.indexOf(t);if(a>-1)return e.splice(a,1)}function getLogic(e){let t=[];return $.ajax({url:ADMIN_URL+e,type:"POST",async:!1,dataType:"JSON",success:function(e){t.push(e)}}),t}function mergeArrayObjects(e,t,a,n,i){return e.map((e,o)=>{if(e.row===t[o].row||e.row===a[o].row||e.row===n[o].row||e.row===i[o].row)return Object.assign({},e,t[o],a[o],n[o],i[o])})}function removeDuplicates(e,t){return[...new Map(e.map(e=>[t(e),e])).values()]}const ADMIN="/backend/";let ID,_table,_tableLine,setSave,ul,formTable,_tableInfo,ORI_URL=window.location.origin,CURRENT_URL=window.location.href,LAST_URL=CURRENT_URL.substr(CURRENT_URL.lastIndexOf("/")+1),ADMIN_URL=ORI_URL+ADMIN,SITE_URL=ADMIN_URL+LAST_URL,option=[],fieldReadOnly=[],fieldChecked=[];const SHOWALL="/showAll",CREATE="/create",SHOW="/show/",EDIT="/edit",DELETE="/destroy/",EXPORT="/export",IMPORT="/import",TABLE_LINE="/tableLine",DELETE_LINE="/destroyLine/";let cardMain=$(".card-main"),cardForm=$(".card-form"),cardBtn=$(".card-button"),cardTitle=$(".card-title");const modalForm=$(".modal_form"),modalDialog=$(".modal-dialog"),modalTitle=$(".modal-title"),modalBody=$(".modal-body");_table=$(".tb_display").DataTable({processing:!0,serverSide:!0,ajax:{url:SITE_URL+SHOWALL,type:"POST",data:function(e){return $.extend({},e,{form:formTable})}},columnDefs:[{targets:[1,-1],orderable:!1,width:2},{targets:0,visible:!1}],order:[],autoWidth:!1,scrollX:checkScrollX(),scrollY:checkScrollY(),scrollCollapse:checkScrollX(),fixedColumns:checkFixedColumns()}),_tableLine=$(".tb_displayline").DataTable({drawCallback:function(e){$(this).find(".number").on("keypress keyup blur",function(e){$(this).val($(this).val().replace(/[^\d].+/,"")),(e.which<48||e.which>57)&&e.preventDefault()}),$(this).find(".select2").select2({placeholder:"Select an option",theme:"bootstrap",allowClear:!0}),$(this).find(".rupiah").autoNumeric("init",{aSep:".",aDec:",",mDec:"0"})},initComplete:function(e,t){$(".tb_displayline").wrap("<div style='overflow:auto; width:100%; position:relative;'></div>")},lengthChange:!1,pageLength:5,searching:!1,ordering:!1,autoWidth:!1}),$(".tb_tree").treeFy({initState:"expanded",treeColumn:0,collapseAnimateCallback:function(e){e.fadeOut()},expandAnimateCallback:function(e){e.fadeIn()}}),_tableInfo=$(".table_info").DataTable({processing:!0,drawCallback:function(e){$(this).find(".number").on("keypress keyup blur",function(e){$(this).val($(this).val().replace(/[^\d].+/,"")),(e.which<48||e.which>57)&&e.preventDefault()}),$(this).find(".select2").select2({placeholder:"Select an option",theme:"bootstrap",allowClear:!0}),$(this).find(".rupiah").autoNumeric("init",{aSep:".",aDec:",",mDec:"0"})},columnDefs:[{targets:[0,1],orderable:!1,width:2},{targets:0,visible:!1}],displayLength:-1,lengthChange:!1,searching:!1,paging:!1,autoWidth:!1,scrollX:!0,scrollY:"350px",scrollCollapse:!0}),$(".save_form").click(function(e){const t=$(e.target).closest(".row");cardForm=t.find(".card-form");const a=cardForm.find("form"),n=$(e.target).closest(".container");let i,o=$(this),s=o.html(),r="create",l=n.find(".page-title").text(),d=isAccess(r,LAST_URL);if(d[0].success&&"Y"==d[0].message){const t=a.find("input, select, textarea");for(let e=0;e<t.length;e++)""!==t[e].name&&a.find("input:checkbox[name="+t[e].name+"], select[name="+t[e].name+"]:not(.line)").removeAttr("disabled");let n=new FormData(a[0]);"add"===setSave?i=SITE_URL+CREATE:"update"===setSave&&(n.append("id",ID),i=SITE_URL+EDIT);for(let e=0;e<t.length;e++)if(""!==t[e].name){if("radio"==t[e].type&&t[e].checked&&n.append(t[e].name,t[e].value),"file"==t[e].type&&t[e].className.includes("control-upload-image"))if(t[e].files.length>0)n.append(t[e].name,t[e].files[0]);else{let i,o=a.find(".img-result").attr("src");i=""!==o?o.substr(o.lastIndexOf("/")+1):o,n.append(t[e].name,i)}(a.find("textarea.summernote[name="+t[e].name+"]").length>0||a.find("textarea.summernote-product[name="+t[e].name+"]").length>0)&&$("[name ="+t[e].name+"]").summernote("isEmpty")&&n.append(t[e].name,""),"select-multiple"===t[e].type&&n.append(t[e].name,$("[name = "+t[e].name+"]").val())}if(a.find("table.tb_tree").length>0){const e=a.find("table.tb_tree"),t=e.find("td input:checkbox");let i=[],o=[],s=[],r=[],l=[];$.each(t,function(){let e,t=$(this).parent().parent().parent().parent().index(),a=$(this).attr("name"),n=$(this).val(),d=$(this).attr("data-menu"),c=void 0!==$(this).attr("id")?$(this).attr("id"):0;e=$(this).is(":checked")?"Y":"N","isview"==a?i.push({row:t,view:e,menu_id:n,menu:d}):"iscreate"==a?o.push({row:t,create:e,menu_id:n,menu:d}):"isupdate"==a?s.push({row:t,update:e,menu_id:n,menu:d}):"isdelete"==a&&r.push({row:t,delete:e,menu_id:n,menu:d}),"add"!==setSave&&l.push({row:t,access_id:c})}),l=removeDuplicates(l,e=>e.row);let d=mergeArrayObjects(i,o,s,r,l);n.append("roles",JSON.stringify(d))}if(a.find("table.tb_displayline").length>0){const e=_tableLine.rows().nodes().to$();let t=[];$.each(e,function(e){let a=$(this).find("input, select, button"),n=[];$.each(a,function(e,t){let a=[],i=$(t).attr("name"),o=$(t).val(),s=$(t).attr("id");a="delete"!==i?"checkbox"!==$(t).attr("type")?{[i]:o}:{[i]:$(t).is(":checked")}:""!==s?{[i]:s}:{[i]:"",ref_id:o},n.push(a)}),t[e]=n}),n.append("table",JSON.stringify(t))}$.ajax({url:i,type:"POST",data:n,processData:!1,contentType:!1,cache:!1,dataType:"JSON",beforeSend:function(){$(o).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...').prop("disabled",!0),$(".x_form").prop("disabled",!0),$(".close_form").prop("disabled",!0),loadingForm(a.prop("id"),"facebook")},complete:function(){$(o).html(s).prop("disabled",!1),$(".x_form").removeAttr("disabled"),$(".close_form").removeAttr("disabled"),hideLoadingForm(a.prop("id"))},success:function(t){if(t[0].success){if(Toast.fire({type:"success",title:t[0].message}),clearForm(e),cardForm.prop("classList").contains("modal"))modalForm.modal("hide");else{const e=cardForm.closest(".container"),t=e.find(".card-body");$.each(t,function(t,a){let n=a.className.split(/\s+/);if(n.includes("card-main")){$(this).css("display","block");let t=ul.find("li");$.each(t,function(e,t){e>2&&t.remove()}),e.find("div.filter_page").length>0&&e.find("div.filter_page").css("display","block")}if(n.includes("card-form")){const t=e.find(".card-header");t.find("button").show(),$(this).css("display","none")}}),cardBtn.css("display","none");const a=e.find(".card-header"),n=a.find("button").prop("classList");n.contains("new_form")&&a.find("button").css("display","block")}cardTitle.html(l),reloadTable()}else t[0].error?(errorForm(a,t),$("html, body").animate({scrollTop:$(".container").offset().top},1500)):Toast.fire({type:"error",title:t[0].message})},error:function(e,t){showError(e,t)}});for(let e=0;e<t.length;e++){let n=a.find("input.active");if(""!==t[e].name&&n.length>0){let n=t[e].className.split(/\s+/);a.find("input.active").is(":checked")?a.find("input:checkbox[name="+t[e].name+"], select[name="+t[e].name+"]").removeAttr("disabled"):n.includes("active")||a.find("input:checkbox[name="+t[e].name+"], select[name="+t[e].name+"]").prop("disabled",!0)}else fieldReadOnly.includes(t[e].name)&&a.find("select[name="+t[e].name+"]").prop("disabled",!0)}}else d[0].success&&"N"==d[0].message?Toast.fire({type:"error",title:"You are role don't have permission, please reload !!"}):Toast.fire({type:"error",title:d[0].message})}),_table.on("click",".edit",function(e){const t=$(e.target).closest(".container"),a=t.find(".card-body"),n=t.find(".card-form"),i=n.find("form");_table.row(this).data();ID=$(this).attr("id");let o,s,r=$(this),l=r.html(),d=[],c="update",m=isAccess(c,LAST_URL);$(this).attr("data-status")&&(s=$(this).attr("data-status")),$(r).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>').prop("disabled",!0),setTimeout(function(){if($(r).html(l).prop("disabled",!1),m[0].success&&"Y"==m[0].message){$.each(a,function(r,l){let d=l.className.split(/\s+/);if(a.length>1){if(d.includes("card-main")){$(this).css("display","none");const e=t.find(".page-header");ul=e.find("ul.breadcrumbs"),ul.find("li.nav-item > a").attr("href",CURRENT_URL);let a='<li class="separator"><i class="flaticon-right-arrow"></i></li>';a+=void 0===s||""===s||"DR"===s?'<li class="nav-item"><a class="text-primary font-weight-bold">Update</a></li>':'<li class="nav-item"><a class="text-primary font-weight-bold">Detail</a></li>',ul.append(a),t.find("div.filter_page").length>0&&t.find("div.filter_page").css("display","none")}if(d.includes("card-form")){const t=$(e.target).closest(".card-header");t.find("button").css("display","none"),$(this).css("display","block"),cardBtn.css("display","block"),o=$(this).prop("classList")}}else openModalForm(),Scrollmodal(),i=modalForm.find("form"),o=n.prop("classList")});const r=i.find("input, textarea, select");if(i.find("select.select-data").length>0){let e=i.find("select.select-data");initSelectData(e)}let l=SITE_URL+SHOW+ID;setSave=void 0===s||""===s||"DR"===s?"update":"detail",$.ajax({url:l,type:"GET",cache:!1,dataType:"JSON",beforeSend:function(){$(".save_form").attr("disabled",!0),$(".x_form").attr("disabled",!0),$(".close_form").attr("disabled",!0),loadingForm(i.prop("id"),"facebook")},complete:function(){"detail"!==setSave&&$(".save_form").removeAttr("disabled"),$(".x_form").removeAttr("disabled"),$(".close_form").removeAttr("disabled"),hideLoadingForm(i.prop("id"))},success:function(e){if(e[0].success){let t=e[0].message;if(t.line){let e=t.line;if(i.find("table.tb_displayline").length>0){let t=JSON.parse(e);$.each(t,function(e,t){_tableLine.row.add(t).draw(!1)});let a=_tableLine.rows().nodes().to$().find("button");const n=_tableLine.rows().nodes().to$().find("input, select");"detail"===setSave&&"DR"!==s?(readonly(i,!0),$(".add_row, .create_line").css("display","none"),a.css("display","none"),$.each(n,function(e,t){const a=$(this).closest("tr");"text"!==t.type?a.find("input:checkbox[name="+t.name+"], select[name="+t.name+"], input:radio[name="+t.name+"]").prop("disabled",!0):a.find("input:text[name="+t.name+"], textarea[name="+t.name+"]").prop("readonly",!0)})):($(".add_row, .create_line").css("display","block"),a.css("display","block"))}if(i.find("table.tb_tree").length>0)for(let t=0;t<e.length;t++){const a=i.find("table.tb_tree"),n=a.find("td input:checkbox");$.each(n,function(a,n){"parent"===$(n).attr("data-menu")?e[t].sys_menu_id==$(n).val()&&0==e[t].sys_submenu_id&&("Y"==e[t].isview&&"isview"===$(n).attr("name")||"Y"==e[t].iscreate&&"iscreate"===$(n).attr("name")||"Y"==e[t].isupdate&&"isupdate"===$(n).attr("name")||"Y"==e[t].isdelete&&"isdelete"===$(n).attr("name")?$(n).prop("checked",!0):$(n).prop("checked",!1),$(n).attr("id",e[t].sys_access_menu_id)):e[t].sys_submenu_id===$(n).val()&&("Y"==e[t].isview&&"isview"===$(n).attr("name")||"Y"==e[t].iscreate&&"iscreate"===$(n).attr("name")||"Y"==e[t].isupdate&&"isupdate"===$(n).attr("name")||"Y"==e[t].isdelete&&"isdelete"===$(n).attr("name")?$(n).prop("checked",!0):$(n).prop("checked",!1),$(n).attr("id",e[t].sys_access_menu_id))})}}if(t.header){let e=t.header;for(let t=0;t<e.length;t++){let a=e[t].field,n=e[t].label;o.contains("modal")&&"title"===a?modalTitle.html(capitalize(n)):"title"===a&&cardTitle.html(capitalize(n));for(let e=0;e<r.length;e++){let t=[];if(""!==r[e].name&&r[e].name===a){let t=r[e].className.split(/\s+/);if(t.includes("datepicker")?i.find("input:text[name="+r[e].name+"]").val(moment(n).format("Y-MM-DD")):t.includes("rupiah")?i.find("input:text[name="+r[e].name+"]").val(formatRupiah(n)):i.find("input:text[name="+r[e].name+"]").val(n),i.find("textarea[name="+r[e].name+"], input:password[name="+r[e].name+"]").val(n),(i.find("textarea.summernote[name="+r[e].name+"]").length>0||i.find("textarea.summernote-product[name="+r[e].name+"]").length>0)&&$("[name ="+r[e].name+"]").summernote("code",n),"select-one"===r[e].type){let t=r[e].name,a=n;if("object"==typeof a){a=n.id;let o=n.name;option.push({fieldName:t,value:a,text:o});let s=$("<option selected='selected'></option>").val(n.id).text(n.name);i.find("select[name="+r[e].name+"]").append(s).change()}else option.push({fieldName:t,value:a}),0!=n&&i.find("select[name="+r[e].name+"]").val(n).change()}if("select-multiple"===r[e].type&&null!==n){let t=n.split(",");t.length>1?i.find("select[name="+r[e].name+"]").val(t).change():(d.push(n),i.find("select[name="+r[e].name+"]").val(d).change())}if("checkbox"===r[e].type&&r[e].checked&&fieldChecked.push(r[e].name),"checkbox"===r[e].type&&"Y"===n)i.find("input:checkbox[name="+r[e].name+"]").prop("checked",!0),t.includes("active")&&readonly(i,!1);else{i.find("input:checkbox[name="+r[e].name+"]").removeAttr("checked"),t.includes("active")&&readonly(i,!0);let a=i.find("input.active");0==a.length&&"detail"!==setSave&&(r[e].readOnly||r[e].disabled)&&fieldReadOnly.push(r[e].name),$(r[e]).attr("edit-disabled")&&i.find("input:checkbox[name="+r[e].name+"], select[name="+r[e].name+"], input:radio[name="+r[e].name+"]").prop("disabled",!0)}"radio"==r[e].type&&r[e].value==n&&(r[e].checked=!0),"file"===r[e].type&&t.includes("control-upload-image")&&previewImage(i.find("input[name="+r[e].name+"]")[0],"",n)}if(""!==r[e].name){if("checkbox"===r[e].type&&$(r[e]).attr("checked-hide-field"))if(t=$(r[e]).attr("checked-hide-field").split(",").map(e=>e.trim()),r[e].checked)for(let e=0;e<t.length;e++){let a=i.find("input[name="+t[e]+"], textarea[name="+t[e]+"], select[name="+t[e]+"]").closest(".form-group, .form-check");a.hide()}else for(let e=0;e<t.length;e++){let a=i.find("input[name="+t[e]+"], textarea[name="+t[e]+"], select[name="+t[e]+"]").closest(".form-group, .form-check");a.show()}if("checkbox"===r[e].type&&$(r[e]).attr("checked-show-field"))if(t=$(r[e]).attr("checked-show-field").split(",").map(e=>e.trim()),r[e].checked)for(let e=0;e<t.length;e++){let a=i.find("input[name="+t[e]+"], textarea[name="+t[e]+"], select[name="+t[e]+"]").closest(".form-group, .form-check");a.show()}else for(let e=0;e<t.length;e++){let a=i.find("input[name="+t[e]+"], textarea[name="+t[e]+"], select[name="+t[e]+"]").closest(".form-group, .form-check");a.hide()}}}}}$("html, body").animate({scrollTop:$(".main-panel").offset().top},500)}else Toast.fire({type:"error",title:e[0].message})},error:function(e,t){showError(e,t)}})}else m[0].success&&"N"==m[0].message?Toast.fire({type:"error",title:"You are role don't have permission, please reload !!"}):Toast.fire({type:"error",title:m[0].message})},50)}),_tableLine.on("click",".btn_delete",function(e){e.preventDefault();const t=$(e.currentTarget).closest("form"),a=_tableLine.$(this).closest("tr"),n=_tableLine.row(a);let i=this.id,o=SITE_URL+DELETE_LINE+i,s=$(this),r=s.html();$(s).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>').prop("disabled",!0),""===i?setTimeout(function(){n.remove().draw(!1),$(s).html(r).prop("disabled",!1)},100):(Swal.fire({title:"Delete?",text:"Are you sure to delete the selected data line ? ",type:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Okay",cancelButtonText:"Close",reverseButtons:!0}).then(e=>{e.value&&$.getJSON(o,function(e){e[0].success?(Swal.fire({title:"Deleted!",text:"Your data has been deleted.",type:"success",showConfirmButton:!1,timer:1e3}),t.find('input[name="grandtotal"]').length>0&&t.find('input[name="grandtotal"]').val(formatRupiah(e[0].message)),n.remove().draw(!1)):Toast.fire({type:"error",title:e[0].message})}).fail(function(e,t){showError(e,t)})}),$(s).html(r).prop("disabled",!1))}),$(document).on("click",".x_form, .close_form",function(e){let t=$(e.currentTarget);const a=t.closest(".container");let n=a.find(".page-title").text();if(setSave="close","modal"!==t.attr("data-dismiss")){const e=t.closest(".container"),a=e.find(".card-body");$.each(a,function(t,a){let n=a.className.split(/\s+/);if(n.includes("card-main")){$(this).css("display","block");let t=ul.find("li");$.each(t,function(e,t){e>2&&t.remove()}),e.find("div.filter_page").length>0&&e.find("div.filter_page").css("display","block")}n.includes("card-form")&&$(this).css("display","none")}),cardBtn.css("display","none");const n=e.find(".card-header");n.find("button").show()}clearForm(e),cardTitle.html(n),$(this).removeAttr("disabled"),$(this).removeAttr("disabled"),$(".save_form").removeAttr("disabled"),$("html, body").animate({scrollTop:$(".main-panel").offset().top},500)}),$(".new_form").click(function(e){const t=$(e.target).closest(".container"),a=t.find(".card-body");let n,i="create",o=t.find(".page-title").text(),s=isAccess(i,LAST_URL);if(s[0].success&&"Y"==s[0].message){if($.each(a,function(i,s){let r=s.className.split(/\s+/);if(a.length>1){if(r.includes("card-main")){$(this).css("display","none");const e=t.find(".page-header");ul=e.find("ul.breadcrumbs"),ul.find("li.nav-item > a").attr("href",CURRENT_URL);let a='<li class="separator"><i class="flaticon-right-arrow"></i></li>';a+='<li class="nav-item"><a class="text-primary font-weight-bold">Create</a></li>',ul.append(a),t.find("div.filter_page").length>0&&t.find("div.filter_page").css("display","none")}if(r.includes("card-form")){const a=$(e.target).closest(".card-header");a.find("button").css("display","none"),$(this).css("display","block"),cardBtn.css("display","block"),cardTitle.html("New "+o),n=$(this).find("form"),n.find("input:file.control-upload-image").length>0&&n.find(".img-result").attr("src","");const i=t.find("input, textarea, select");for(let e=0;e<i.length;e++){let t=[];if(""!==i[e].name){if((i[e].readOnly||i[e].disabled)&&fieldReadOnly.push(i[e].name),"checkbox"==i[e].type&&fieldChecked.includes(i[e].name)&&n.find("input:checkbox[name="+i[e].name+"]").prop("checked",!0),$(i[e]).attr("checked-hide-field"))if(t=$(i[e]).attr("checked-hide-field").split(",").map(e=>e.trim()),i[e].checked)for(let e=0;e<t.length;e++){let a=n.find("input[name="+t[e]+"], textarea[name="+t[e]+"], select[name="+t[e]+"]").closest(".form-group, .form-check");a.hide()}else for(let e=0;e<t.length;e++){let a=n.find("input[name="+t[e]+"], textarea[name="+t[e]+"], select[name="+t[e]+"]").closest(".form-group, .form-check");a.show()}if($(i[e]).attr("checked-show-field"))if(t=$(i[e]).attr("checked-show-field").split(",").map(e=>e.trim()),i[e].checked)for(let e=0;e<t.length;e++){let a=n.find("input[name="+t[e]+"], textarea[name="+t[e]+"], select[name="+t[e]+"]").closest(".form-group, .form-check");a.show()}else for(let e=0;e<t.length;e++){let a=n.find("input[name="+t[e]+"], textarea[name="+t[e]+"], select[name="+t[e]+"]").closest(".form-group, .form-check");a.hide()}}}}}else openModalForm(),Scrollmodal(),modalTitle.html("New1 "+capitalize(LAST_URL)),n=modalForm.find("form"),n.find("input:file.control-upload-image").length>0&&n.find(".img-result").attr("src","")}),n.find("input.code").length>0&&setSeqCode(n),n.find("select.select-data").length>0){let e=n.find("select.select-data");initSelectData(e)}n.find('input[type="checkbox"].active').prop("checked",!0),setSave="add"}else s[0].success&&"N"==s[0].message?Toast.fire({type:"warning",title:"You are role don't have permission, please reload !!"}):Toast.fire({type:"error",title:s[0].message})}),$(".btn_export").click(function(e){const t=$(e.target).closest(".container"),a=t.find(".card-filter");let n=a.find("form"),i=$(this),o=i.html();n.attr("action",SITE_URL+EXPORT),n.attr("method","POST"),n.submit(),$(i).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...').prop("disabled",!0),setTimeout(function(){$(i).html(o).prop("disabled",!1)},700)}),$(".btn_filter").click(function(e){const t=$(e.target).closest("form");let a=$(this),n=a.html();formTable=t.serializeArray(),$(a).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...').prop("disabled",!0),setTimeout(function(){$(a).html(n).prop("disabled",!1)},700),reloadTable()}),$(".add_row").click(function(e){
let t=$(e.target).closest("form"),a=SITE_URL+TABLE_LINE,n="create",i=isAccess(n,LAST_URL);if(i[0].success&&"Y"==i[0].message){let e=$(this),n=e.html(),i=new FormData(t[0]);$.ajax({url:a,type:"POST",data:i,processData:!1,contentType:!1,cache:!1,dataType:"JSON",beforeSend:function(){$(e).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...').prop("disabled",!0)},complete:function(){$(e).html(n).prop("disabled",!1)},success:function(e){_tableLine.row.add(e).draw(!1)},error:function(e,t){showError(e,t)}})}else i[0].success&&"N"==i[0].message?Toast.fire({type:"warning",title:"You are role don't have permission !!"}):Toast.fire({type:"error",title:i[0].message})}),$(".create_line").click(function(e){let t="create",a=isAccess(t,LAST_URL);if(a[0].success&&"Y"==a[0].message){let e=$(this),t=e.html();$(e).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...').prop("disabled",!0),setTimeout(function(){$(e).html(t).prop("disabled",!1),$("#modal_product_info").modal({backdrop:"static",keyboard:!1}),loadingForm("product_info","ios"),$("#modal_product_info").on("shown.bs.modal",function(e){const t=$(e.target),a=t.find("form");let n=ADMIN_URL+"product/showProductInfo/?data=null";a[0].reset(),setTimeout(function(){if(hideLoadingForm("product_info"),a.find("select.select-data").length>0){let e=a.find("select.select-data");initSelectData(e)}_tableInfo.ajax.url(n).load().columns.adjust()},50)})},100)}else a[0].success&&"N"==a[0].message?Toast.fire({type:"warning",title:"You are role don't have permission !!"}):Toast.fire({type:"error",title:a[0].message})}),$("#modal_product_info").on("hidden.bs.modal",function(e){const t=$(e.target),a=t.find("form");a[0].reset(),_tableInfo.clear().draw()}),$(".btn_requery_info").click(function(e){const t=$(e.target),a=t.closest(".modal-content"),n=a.find("form");let i=ADMIN_URL+"product/showProductInfo/?",o=n.serialize();_tableInfo.ajax.url(i+o).load().columns.adjust()}),$(".btn_save_info").click(function(e){const t=$(this).closest(".modal"),a=t.find(".modal-body"),n=_tableInfo.rows().nodes().to$().find('input:checkbox[name="check_data"]:checked');let i=$(this),o=i.html();if(n.length>0){let e=SITE_URL+TABLE_LINE+"/create",s=[];$.each(n,function(e){let t=$(this).closest("tr"),a=t.find("input, select"),n=[];$.each(a,function(e,t){let a=[],i=$(t).attr("name"),o=$(t).val();a="checkbox"!==$(t).attr("type")?{[i]:o}:"check_data"===i?{product_id:o}:{[i]:$(t).is(":checked")},n.push(a)}),s[e]=n});let r=JSON.stringify(s);$.ajax({url:e,type:"POST",data:{data:r},cache:!1,dataType:"JSON",beforeSend:function(){$(i).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>').prop("disabled",!0),$(".btn_requery_info").attr("disabled",!0),$(".btn_close_info").attr("disabled",!0),loadingForm(a.attr("id"),"ios")},complete:function(){$(i).html(o).prop("disabled",!1),$(".btn_requery_info").removeAttr("disabled"),$(".btn_close_info").removeAttr("disabled"),hideLoadingForm(a.attr("id"))},success:function(e){$("#"+t.attr("id")).modal("hide"),_tableLine.rows.add(e).draw(!1)},error:function(e,t){showError(e,t)}})}else Toast.fire({type:"warning",title:"Please selected data !!"})}),$(".btn_login").click(function(){let e=$(this),t=e.html();const a=$(this).closest("form");let n=ADMIN_URL+"auth/login";$.ajax({url:n,type:"POST",data:a.serialize(),cache:!1,dataType:"JSON",beforeSend:function(){$(this).prop("disabled",!0),$(e).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...').prop("disabled",!0)},complete:function(){$(this).removeAttr("disabled"),$(e).html(t).prop("disabled",!1)},success:function(e){e[0].success?(Toast.fire({type:"success",title:e[0].message}),window.open(ORI_URL+"/sas","_self")):e[0].error?errorForm(a,e):Toast.fire({type:"error",title:e[0].message})},error:function(e,t){showError(e,t)}})}),$(".login-form input").keypress(function(e){let t=e.which;13==t&&$(".btn_login").click()}),$(".change-password").click(function(e){openModalForm()}),$(".save_form_pass").click(function(e){const t=$(e.target).closest(".modal"),a=t.find("form");let n=$(this),i=n.html(),o=ADMIN_URL+"auth/changePassword",s=new FormData(a[0]);$.ajax({url:o,type:"POST",data:s,processData:!1,contentType:!1,cache:!1,dataType:"JSON",beforeSend:function(){$(".close").prop("disabled",!0),loadingForm(a.prop("id"),"facebook"),$(n).html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...').prop("disabled",!0)},complete:function(){$(".close").prop("disabled",!1),hideLoadingForm(a.prop("id")),$(n).html(i).prop("disabled",!1)},success:function(t){if(t[0].success)Toast.fire({type:"success",title:t[0].message}),clearForm(e),$(".modal_form").modal("hide");else if(t[0].error){let e=t[0].message;$.each(e,function(e,t){""!==t?(a.find('input:password[name="'+e+'"]').closest(".form-group").addClass("has-error"),a.find("small[id=error_"+e+"]").html(t)):(a.find('input:password[name="'+e+'"]').closest(".form-group").removeClass("has-error"),a.find("small[id=error_"+e+"]").html(""))})}else Toast.fire({type:"error",title:t[0].message})},error:function(e,t){showError(e,t)}})}),$("input.active:checkbox").change(function(e){const t=$(this).closest("form"),a=t.find("input, textarea, select");let n;if($(this).is(":checked"))for(let e=0;e<a.length;e++)""!==a[e].name&&(n=a[e].className.split(/\s+/),fieldReadOnly.includes(a[e].name)||t.find("input:text[name="+a[e].name+"], textarea[name="+a[e].name+"], input:password[name="+a[e].name+"]").removeAttr("readonly"),"text"===a[e].type||n.includes("active")||fieldReadOnly.includes(a[e].name)||(t.find("input:checkbox[name="+a[e].name+"], select[name="+a[e].name+"]").removeAttr("disabled"),"file"===a[e].type&&(t.find("input[name="+a[e].name+"]").removeAttr("disabled"),t.find("button.close-img").removeAttr("disabled").css("display","block"))),(t.find("textarea.summernote[name="+a[e].name+"]").length>0||t.find("textarea.summernote-product[name="+a[e].name+"]").length>0)&&$("[name ="+a[e].name+"]").summernote("enable"));else for(let e=0;e<a.length;e++)""!==a[e].name&&(n=a[e].className.split(/\s+/),(a[e].readOnly||a[e].disabled)&&fieldReadOnly.push(a[e].name),fieldReadOnly.includes(a[e].name)||t.find("input:text[name="+a[e].name+"], textarea[name="+a[e].name+"], input:password[name="+a[e].name+"]").prop("readonly",!0),"text"===a[e].type||n.includes("active")||fieldReadOnly.includes(a[e].name)||(t.find("input:checkbox[name="+a[e].name+"], select[name="+a[e].name+"]").prop("disabled",!0),"file"===a[e].type&&(t.find("input[name="+a[e].name+"]").prop("disabled",!0),t.find("button.close-img").prop("disabled",!0).css("display","none"))),(t.find("textarea.summernote[name="+a[e].name+"]").length>0||t.find("textarea.summernote-product[name="+a[e].name+"]").length>0)&&$("[name ="+a[e].name+"]").summernote("disable"))}),$(".close-img").click(function(e){const t=$(e.currentTarget).closest("div"),a=t.closest(".form-group"),n=a.find(".form-upload"),i=$(e.currentTarget).closest("form"),o=i.find("input");let s=t.find("label").prop("className");if(s.includes("form-result")){n.find("label").css("display","block"),t.find("label").css("display","none"),n.find("input:file").val(""),t.find(".img-result").attr("src","");for(let e=0;e<o.length;e++)""!==o[e].name&&"file"===o[e].type&&(i.find("input[name="+o[e].name+"]").removeAttr("disabled"),t.find("button.close-img").removeAttr("disabled").css("display","block"))}});const capitalize=e=>"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1);$(document).ready(function(e){$(".select2").select2({placeholder:"Select an option",width:"100%",theme:"bootstrap",allowClear:!0}),$(".multiple-select").select2({theme:"bootstrap"}),$(".number").on("keypress keyup blur",function(e){$(this).val($(this).val().replace(/[^\d].+/,"")),(e.which<48||e.which>57)&&e.preventDefault()}),Toast=Swal.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:4e3}),$(".datepicker").datetimepicker({format:"YYYY-MM-DD"}),$(".timepicker").datetimepicker({format:"H:mm:ss"}),$(".summernote").summernote({fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Times New Roman"],tabsize:2,height:200,toolbar:[["style",["style","bold","italic","underline","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["view",["fullscreen","codeview","help"]],["height",["height"]]],placeholder:"write here..."}),$(".summernote-product").summernote({fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Times New Roman"],tabsize:2,height:200,toolbar:[["style",["style","bold","italic","underline","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["height",["height"]]],placeholder:"write here..."}),$(".float-number").autoNumeric("init",{aSep:",",mDec:"0"}),window.setTimeout(function(){$(".alert ").fadeTo(500,0).slideUp(500,function(){$(this).remove()})},4e3)}),$(document).ready(function(e){const t=$(".form");if(t.length>0){const e=t.prop("classList");if(!arrContains("form_page",e)){let a=t.find("input.id:hidden");ID=a.val();const n=t.find("input, textarea, select");let i=SITE_URL+SHOW+ID;setSave="update",$.ajax({url:i,type:"GET",async:!1,cache:!1,dataType:"JSON",beforeSend:function(){$(".save_form").attr("disabled",!0),loadingForm(t.find("form").attr("id"),"facebook")},complete:function(){$(".save_form").removeAttr("disabled"),hideLoadingForm(t.find("form").attr("id"))},success:function(a){cardTitle.html(capitalize(LAST_URL));for(let i=0;i<a.length;i++){let o=a[i].field,s=a[i].label;for(let t=0;t<e.length;t++)"show"===e[t].toLowerCase()&&"title"===o?modalTitle.html(capitalize(s)):"title"===o&&cardTitle.html(capitalize(s));for(let e=0;e<n.length;e++)n[e].name===o&&(t.find("input:text[name="+n[e].name+"], textarea[name="+n[e].name+"]").val(s),t.find("select[name="+n[e].name+"]").val(s).change())}}})}}}),$("select").change(function(e){let t=$(e.target),a="";const n=$(this).closest("form");let i=$(this).closest(".card-filter").length;if(0==option.length){if("md_principal_id"===t.attr("id")||"md_principal_id"===t.attr("name")){a=t.val(),url=SITE_URL+"/getCategory";for(let e=1;e<=3;e++)0!=a?(n.find('select[name = "category'+e+'"]').empty(),$.ajax({url:url,type:"POST",data:{principal:a,level:e},cache:!1,dataType:"JSON",success:function(t){if(i>0?n.find('select[name = "category'+e+'"]').append('<option value="0">All Categories '+(e>1?e:"")+"</option>"):n.find('select[name = "category'+e+'"]').append('<option value="0">&nbsp;</option>'),t[0].success){let a=t[0].message;$.each(a,function(t,a){let i=a.md_category_id,o=(a.category,a.category_en);n.find('select[name = "category'+e+'"]').append('<option value="'+i+'">'+o+"</option>")})}else Swal.fire({type:"error",title:t[0].message,showConfirmButton:!1,timer:1500})},error:function(e,t){showError(e,t)}})):n.find('select[name = "category'+e+'"]').empty()}}else{url=SITE_URL+"/getCategory";let e=option[option.length-1],t=e.fieldName,i=e.value;if(a=$(".main-select").val(),"category"===t.slice(0,-1)){let e=t[t.length-1];n.find("select[name ="+t+"]").empty(),$.ajax({url:url,type:"POST",data:{principal:a,level:e},cache:!1,dataType:"JSON",success:function(e){if(n.find("select[name ="+t+"]").append('<option value="0">&nbsp;</option>'),e[0].success){let a=e[0].message;$.each(a,function(e,a){let o=a.md_category_id,s=a.category_en;i==o?n.find("select[name ="+t+"]").append('<option value="'+o+'" selected>'+s+"</option>"):n.find("select[name ="+t+"]").append('<option value="'+o+'">'+s+"</option>")}),option=[]}else Swal.fire({type:"error",title:e[0].message,showConfirmButton:!1,timer:1500})},error:function(e,t){showError(e,t)}})}}}),$(document).on("click","input:checkbox",function(){const e=$(this).closest("table"),t=$(this).closest("tr");let a,n=$(this).closest("th").index(),i=$(this).parent().parent().parent().index(),o=i+1;$(this).is(":checked")?(n>0&&e.find("td:nth-child("+o+") input:checkbox").prop("checked",!0),(t.hasClass("treetable-expanded")||t.hasClass("treetable-collapsed"))&&(a=t.attr("data-node").substring(10),e.find("tr[data-pnode=treetable-parent-"+a+"] td:nth-child("+o+") input:checkbox").prop("checked",!0))):(n>0&&e.find("td:nth-child("+o+") input:checkbox").prop("checked",!1),(t.hasClass("treetable-expanded")||t.hasClass("treetable-collapsed"))&&(a=t.attr("data-node").substring(10),e.find("tr[data-pnode=treetable-parent-"+a+"] td:nth-child("+o+") input:checkbox").prop("checked",!1)))});